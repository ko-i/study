# 第6章 指针

---
### 问题

#### 1. 如果一个值的类型无法简单地通过观察它的位模式来判断，那么机器是如何知道应该怎样对这个值进行操纵的？
* 看程序员（编译器）具体如何来使用它（对它赋予什么类型）。机器什么都不知道。

---
#### 2. C为什么没有一种方法来声明字面值指针常量呢？
* 因为这样的自由过于危险，指向非法地址的门槛大大降低了。

---
#### 3. 假定一个整数的值是244。为什么机器不会把这个值解释为一个内存地址呢？
* 答案与第一题相似，机器什么都不知道，看程序员（编译器）具体如何使用这个值。

---
#### 4. 在有些机器上，编译器在内存位置零存储0这个值。对NULL指针进行解引用操作将访问这个位置。这种方法会产生什么后果？
* 这种方法产生的结果应该是未定义的，具体看编译器如何实现，有可能报错，也有可能什么都不说。但这种行为总归是很危险的，不要尝试这么做。

---
#### 5. 表达式（a）和（b）的求值过程有没有区别？如果有的话，区别在哪里？假定变量`offset`的值为`3`。
``` c
int i[10];
int *p = &i[0];
int offset;

p += offset;  // (a)
p += 3;       // (b)
```
* 没有区别。

---
#### 6. 下面代码段有没有问题？如果有的话，问题在哪里？
``` c
int array[ARRAY_SIZE];
int *pi;

for(pi = &array[0]; pi < &array[ARRAY_SIZE];)
{
    *++pi = 0;
}
```
* array[0]的值并没有被成功初始化。
* 也会产生数组越界的错误，++pi会导致指针成功指向&array[ARRAY_SIZE]的地址并对其赋值为0；

---
#### 7. 下面的表显示了几个内存位置的内容。每个位置由它的地址和存储于该位置的变量名标识。所有数字以十进制表示。使用这些值，用四种方法分别计算下面各个表达式的值。首先，假定所有变量都是整形，找到表达式的右值，在找到它的左值，给出它所指定的内存位置的地址。接着，假定所有变量都是指向整形的指针，重复上述步骤。注意：在执行地址运算时，假定整形和指针的长度都是4个字节。

| 变量 | 地址 | 内容 | 变量 | 地址 | 内容 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| a | 1040 | 1028 | o | 1096 | 1024 |
| c | 1056 | 1076 | q | 1084 | 1072 |
| d | 1008 | 1016 | r | 1068 | 1048 |
| e | 1032 | 1088 | s | 1004 | 2000 |
| f | 1052 | 1044 | t | 1060 | 1012 |
| g | 1000 | 1064 | u | 1036 | 1092 |
| h | 1080 | 1020 | v | 1092 | 1036 |
| i | 1020 | 1080 | w | 1012 | 1060 |
| j | 1064 | 1000 | x | 1072 | 1080 |
| k | 1044 | 1052 | y | 1048 | 1068 |
| m | 1016 | 1008 | z | 2000 | 1000 |
| n | 1076 | 1056 |  |  |  |

* 解答如下：

|  |  | 整形 |  | 整形指针 |  |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 序号 | 表达式 | 右值 | 左值地址 | 右值 | 左值地址 |
| a | m | 1008 | 1016 | 1008 | 1016 |
| b | v + 1 | 1037 | - | 1040 | - |
| c | j - 4 | 999 | - | 996 | - |
| d | a - d | 12 | - | 48 | - |
| e | v - w | 56 | - | 224 | - |
| f | &c | 1056 | - | 1056 | - |
| g | &e + 1 | 1036 | - | 1036 | - |
| h | &o - 4 | 1080 | - | 1080 | - |
| i | &(f + 2) | - | - | - | - |
| j | *g | - | - | 1000 | j的地址 |
| k | *k + 1 | - | - | 1045 | - |
| l | *(n + 1) | - | - | 1012 | t的地址 |
| m | *h - 4 | - | - | 1076 | - |
| n | *(u - 4) | - | - | - | 地址为1088，但此地址未声明 |
| o | *f - g | - | - | - | - |
| p | *f - *g | - | - | 52 | - |
| q | *s - *q | - | - | -20 | - |
| r | *(r - t) | - | - | - | - |
| s | y > i | 0 | - | - | - |
| t | y > *i | - | - | - | - |
| u | *y > *i | - | - | 1 | - |
| v | **h | - | - | - | - |
| w | c++ | 1076 | - | 1076 | n的地址 |
| x | ++c | 1077 | - | 1080 | h的地址 |
| y | *q++ | - | - | 1080 | - |
| z | (*q)++ | - | - | 1072 | - |
| aa | *++q | - | - | 1056 | - |
| bb | ++*q | - | - | 1081 | - |
| cc | *++*q | - | - | - | - |
| dd | ++*(*q)++ | - | - | - | - |

---

### 编程练习

#### 1. 
* pe6.1.c

#### 2. 
* pe6.2.c

#### 3. 
* pe6.3.c

#### 4. 
* pe6.4.c

#### 5. 
* pe6.5.c

#### 6. 
* pe6.6.c

---