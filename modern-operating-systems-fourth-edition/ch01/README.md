# 第1章 引论

### 习题

---
#### 1. 操作系统的两大主要作用是什么？
* 为用户程序提供抽象和管理计算机资源。

---
#### 2. 在1.4节中描述了9种不同的操作系统，列举每种操作系统的应用（每种系统一种应用）
1. 大型机操作系统：OS/390 Linix...
    - 批处理：保险公司的索赔处理，连锁商店的销售报告。
    - 事务处理：银行支票处理，航班预订。（大量小的请求）
    - 分时：大型数据库上的查询。（多个远程用户同时在计算机上运行作业）
2. 服务器操作系统：Solaris, FreeBSD...
    - 打印服务，文件服务，web服务。
3. 多处理器操作系统：Windows, Linux
    - 比如现在的多核处理器。
4. 个人计算机操作系统：Linux, Windows
    - 文字处理，电子表格，游戏和internet访问。
5. 掌上计算机操作系统：iOS, Android
    - 现在的智能手机，IOS，Android与在其上面丰富的第三方应用。
6. 嵌入式操作系统：Linux, QNX
    - 微波炉，电视机等等。
7. 传感器节点操作系统：TinyOS
    - 温度，降水量测量等
8. 实时操作系统：eCos
    - 汽车装配等
9. 智能卡操作系统：Java VM
    - 运行Java小程序。

---
#### 3. 分时系统和多道程序系统的区别是什么？
* 分时系统是作业按时间轮流使用全部的系统资源，而多道程序系统是每项作业分配一部分系统资源，但它可以一直运行。

---
#### 4. 为了使用高速缓存，主存被划分为若干cache行，通常每行长32或64字节。每次缓存一整个cache而不是一个字节或一个字，这样做的优点是什么？
* 一次读入多数数据，这些数据因为相邻的原因，很大概率会在之后也被使用，一次读取可以避免了多次读取带来的时间延迟。

---
#### 5. 在早期计算机中，每个字节的读写直接由CPU处理（即没有DMA）。对于多道程序而言这种组织方式有什么含义？
* 处理器直接处理IO会占用大量时间造成效率降低。多道程序最好还是要用DMA。

---
#### 6. 与访问I/O设备相关的指令通常是特权指令，也就是说，他们能在内核态执行而在用户态则不行。说明为什么这些指令是特权指令。
* I/O操作有可能会读不属于自己的数据，自己无权访问的数据，或者写时覆盖了其它已有的数据，甚至覆盖掉操作系统数据，这些行为很危险需要控制。

---
#### 7. 系列计算机思想在20世纪60年代由IBM引入System/360大型机。这种思想已经消亡了还是继续活跃着？
* 活跃着，比如现在每一代cpu，gpu都分级出不同的性能型号。

---
#### 8. 缓慢采用GUI的一个原因是支持它的硬件的成本高昂。为了支持25行80列字符的单色文本屏幕，需要多少视频RAM？对于一个1024*768像素24位色彩位图需要多少视频RAM？在1980年（每KB5美元），这些RAM的成本是多少？现在它的成本是多少？
* 0.25KB 2204KB 1.25美元 11020美元 现在不值钱。

---
#### 9. 在建立一个操作系统时有几个设计目的，例如资源利用、及时性、健壮性等。请列举出两个互相矛盾的设计目的。
* 公平性和及时性，公平性要求每个应用获得公分的资源分配，而及时性又会将资源优先分配给优先级高的应用。

---
#### 10. 内核态和用户态有哪些区别？解释在设计操作系统时存在两种模式有什么帮助？
* 区分内核态和用户态是为了操作系统安全与健壮。因为有些行为有可能产生危险的结果，将这些行为放入内核态加以控制可以保护操作系统不至于因为一个程序错误而整体崩溃。

---
#### 11. 一个255GB大小的磁盘有65535个柱面，每个磁道有255个扇区，每个扇区有512字节。这个磁盘有多少盘片和磁头？假设平均寻道时间为11ms，平均旋转延迟为7ms，读取速率为100MB/s，计算从一个扇区读取400KB需要的平均时间。
* 16 32 22ms

---
#### 12. 下面哪一条指令只能在内核态使用？(a) 禁止所有中断。（b）读取日期-时间时钟。（c）设置日期-时间时钟。（d）改变存储器映像。
* a，c，d

---
#### 13. 考虑一个有两个CPU的系统，并且没一个CPU有两个线程。假设有三个程序P0、P1、P2，分别以运行时间5ms、10ms、20ms开始。运行这些程序需要多少时间？假设这三个程序都是100%限于CPU，在运行时无阻塞，并且一旦设定就不改变CPU。
* 20ms

---
#### 14. 一台计算机有一个四级流水线，每一级都花费相同时间工作，即1ns。这台机器每秒可以执行多少条指令？
* 1000000000条。

---
#### 15. 假设一个计算机系统有高速缓存、内存（RAM）以及磁盘，操作系统用虚拟内存。读取缓存中的一个词需要1ns，RAM需要10ns，磁盘需要10ms。如果缓存的命中率是95%，内存的是99%，读取一个词的平均时间是多少？
* (1 * 0.95)ns + (10 * 0.05)ns + (10ms * 0.05 * 0.01) = 5001.6ns

---
#### 16. 在用户程序进行一个系统调用，以读写磁盘文件时，该程序提供指示说明了所需要的文件，一个指向数据缓冲区的指针以及计数。然后，控制权转给操作系统，它调用相关的驱动程序，假设驱动程序启动磁盘并且直到中断发生才终止。在从磁盘读的情况下，很明显，调用者会被阻塞（因为文件中没有数据）。在向磁盘写的时候会发生什么情况？需要拔掉用着阻塞一直等到磁盘传送完成为止吗？
* 当然不用，想磁盘写的时候操作系统会将需要写的数据传送给DMA，然后就可以做其他事了。除非调用者在未写完成的时候又执行写操作。

---
#### 17. 什么是陷阱指令？在操作系统中截是它的用途。
* 该指令可以将处理器的执行模式从用户模式转到内核模式，可以让用户程序调用操作系统中的内核函数。

---
#### 18. 在分时系统中为什么需要进程表？在只有一个进程存在的个人计算机系统中，该进程控制整个机器知道进程结束，这种机器也需要进程表吗？
* 进程表存储了当前被挂起，阻塞，延迟的进程，为了之后恢复使用。如果一周一个进程，应该是不用了。

---
#### 19. 说明有没有理由在一个非空目录中安装一个文件系统。如果要这样做，如何做。
* 安装文件系统时会导致这个目录其它文件都不可访问，但如果文件系统损坏，这些文件就又可以访问了，所以可以放些重要文件在这以备文件系统损坏时使用。

---
#### 20. 对于下列系统调用，给出引起失败的条件：fork，exec以及unlink。
* fork：进程表中没有空闲。
* exec：没有执行权限或执行文件不存在。
* unlink：解除链接文件不存在或没有解除权限。

---
#### 21. 下列资源能使用哪种多路复用（时间，空间或者两者均可）：CPU，内存，磁盘，网卡，打印机，键盘以及显示器。
* 时间：CPU，网卡，打印机，键盘。
* 空间：内存，磁盘。
* 两者：显示器。

---
#### 22. 在`count = write(fd, budder, nbytes);`调用中，是否能将函数返回值传递给count变量而不是nbytes变量，如果能，为什么？
* 本来函数返回值就是传递给count变量的。

---
#### 23. 有一个文件，其文件描述符是fd，内含下列字节序列：3，1，4，1，5，9，2，6，5，3，5。有如下调用：lseek(fd, 3, SEEK_SET); read(fd, &buffer, 4);其中lseek调用寻找文件中的字节3.在读操作完成后buffer中的内容是什么？
* 1，5，9，2

---
#### 24. 假设一个10MB的文件保存在磁盘同一磁道（磁道号为50）的连续扇区中。磁盘臂此时位于第100号磁道。要想从磁盘上找回这个文件，需要多长时间？假设磁盘的磁臂从一个柱面移动到下一个柱面需要1ms，保存文件的开始部分的扇区旋转到磁头下需要5ms，并且读取速率是200MB/s。
* 105ms

---
#### 25. 块特殊文件和字符特殊文件的基本差别是什么？
* 块特殊文件包含每个块的编号，每个块可以独立的读取和写入，但是字符特殊文件就像流，只能顺序读取和写入。

---
#### 26. 在图1-17的例子中库调用成为read()，而系统调用自身称为read()。这两者都有相同的名字是正常的吗？如果不是，哪一个更重要？
* 系统调用只有编号没有名称。都挺重要的。

---
#### 27. 现代操作系统将进程的地址空间从机器物理内存中分离出来。列举这种设计的两个好处。
1. 可以充分利用内存，因为不用非要连续的内存地址。
2. 可以方便的为每个用户程序划分自己的内存空间。

---
#### 28. 对程序员而言，系统调用就像对其他库过程的调用一样。有无必要让程序员了解哪一个库过程导致了系统调用？在什么情况下？为什么？
* 如果程序员了解了哪些库调用会导致系统调用，那他可以尝试用其他方法避免系统调用而导致的性能开销，从而优化程序运行。

---
#### 29. 图1-23说明有一批UNIX系统调用没有与之等价的WIN32 API。对于所列出的每一个没有Win32等价的调用，若程序员要吧一个UNIX程序转换到Windows运行，会有什么后果？
1. execve
2. link
3. mount
4. umount
5. chmod
6. kill

无法正常运行。

---
#### 30. 可移植的操作系统是从一个系统体系结构移动到另一个系统体系结构下而不需要任何修改的操作系统。请解释为什么建立一个完全可移植性的操作系统是不可行的。描述一下设计一个高度可移植的操作系统时你设计的两个高层是怎样的？
* 因为硬件条件不相同，需求也不相同，有的轻量级，有的复杂，所以怎么可能呢。
* 一个高度可移植的操作系统将包括两个高级层——一个机器相关层和一个机器独立层。机器相关层屏蔽硬件的细节，必须为每一个架构单独实现，该层提供了一个统一的接口。机器独立层只需要实现一次。为了实现高度可移植，机器相关层应尽可能小。

---
#### 31. 请解释在建立于微内核的操作系统时策略与机制分离带来的好处。
* 可以使系统内核变得更小。

---
#### 32. 虚拟机由于很多因素而十分流行，然而他们也有一些缺点，给出一个缺点。
* 运行速度较慢，更高的性能开销。

---
#### 33. 下面是一些单位转换的练习：
1. 一微年是多少秒？ 31.536秒
2. 微米常称为micron。那么meigamicron是多长？ 1米
3. 1PB存储器中有多少字节？ 10^50字节
4. 地球的质量是6000yottagram，换算成kilogram是多少？ 6yottakilogram

---
#### 34. 写一个和图1-19类似的shell，但是包含足够的实际可工作的代码，这样可以测试它。还可以添加某些功能，如输入输出重定向、管道以及后台作业等。
* pe34.c

---
#### 35. 如果你有一个个人UNIX类操作系统（Linux、MINIX/3、FreeBSD等），可以安全的崩溃和再启动，请写一个试图创建无限制数量子进程的shell脚本并观察所发生的的事。在运行实验之前，通过shell键入sync，在磁盘上备好文件缓冲区以避免损坏文件系统。注意：在没有得到系统管理员的允许之前，不要在分时系统上进行这一尝试。其后果将会立即出现，尝试者可能会被抓住并受到惩罚。
* pe35.c

---
#### 36. 用一个类似与UNIX od的工具考察并尝试解释UNIX类系统或Windows的目录。提示：如何进行取决于OS允许做什么。一个有益的技巧是在软盘上创建一个目录，其中包含一个操作系统，然后使用另一个允许进行此类访问的不同的操作系统读取盘上的原始数据。
* 略

---





